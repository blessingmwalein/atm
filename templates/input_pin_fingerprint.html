<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>ATM System Login: Input Pin</title>
    <meta
      name="description"
      content="Flat UI Kit Free is a Twitter Bootstrap Framework design and Theme, this responsive framework includes a PSD and HTML version."
    />

    <meta
      name="viewport"
      content="width=1000, initial-scale=1.0, maximum-scale=1.0"
    />
    <link
      href=" {{ url_for('static',filename='dist/css/vendor/bootstrap/css/bootstrap.min.css') }}"
      rel="stylesheet"
    />
    <link
      href=" {{ url_for('static',filename='dist/css/flat-ui.css') }}"
      rel="stylesheet"
    />
    <link
      href=" {{ url_for('static',filename='docs/assets/css/demo.css') }}"
      rel="stylesheet"
    />
    <link
      href=" {{ url_for('static',filename='css/custom.css') }}"
      rel="stylesheet"
    />
    <script src=" {{ url_for('static',filename='dist/js/vendor/html5shiv.js') }}"></script>
    <script src=" {{ url_for('static',filename='dist/js/vendor/respond.min.js') }}"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="demo-headline" style="padding: 0px">
        <h1 class="demo-logo">
          ATM
          <small>24 Hour Banking</small>
        </h1>
      </div>
      <!-- /demo-headline -->
      <div class="row">
        <div class="col-xs-12" id="screenView">
          <!-- Place <h1></h1> below -->

          <!-- Replace Video with Animated Gif or Animated SVG -->
          <div class="row">
            <form
              action="{{ url_for('authenticate') }}"
              class="col-xs-8 text-center"
              id="pinForm"
              method="POST"
              style="border-right: solid 3px #ccc"
            >
              <h1 class="demo-section-title text-uppercase text-center">
                Insert Card/ Enter Account Number / Scan Fingerprint to Begin
              </h1>
              <div class="form-group">
                <label>Pin</label>
                <input
                  type="text"
                  id="userPinInput"
                  class="form-control"
                  style="color: black; font-weight: bold"
                  name="userPinInput"
                  readonly
                />
              </div>
              <div class="form-group">
                <label>Account Number</label>
                <input
                  type="text"
                  id="accountNumber"
                  class="form-control"
                  style="color: black; font-weight: bold"
                  name="accountNumber"
                  readonly
                />
              </div>
              <!-- TABLE -->
              <div id="pinPad">
                <table>
                  <tr>
                    <td>
                      <a
                        id="btn1"
                        href="#"
                        onclick="event.preventDefault();addInput('1')"
                        class="btn btn-block btn-lg btn-inverse"
                        >1</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn2"
                        href="#"
                        onclick="event.preventDefault();addInput('2')"
                        class="btn btn-block btn-lg btn-inverse"
                        >2</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn3"
                        href="#"
                        onclick="event.preventDefault();addInput('3')"
                        class="btn btn-block btn-lg btn-inverse"
                        >3</a
                      >
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <a
                        id="btn4"
                        href="#"
                        onclick="event.preventDefault();addInput('4')"
                        class="btn btn-block btn-lg btn-inverse"
                        >4</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn5"
                        href="#"
                        onclick="event.preventDefault();addInput('5')"
                        class="btn btn-block btn-lg btn-inverse"
                        >5</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn6"
                        href="#"
                        onclick="event.preventDefault();addInput('6')"
                        class="btn btn-block btn-lg btn-inverse"
                        >6</a
                      >
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <a
                        id="btn7"
                        onclick="event.preventDefault();addInput('7')"
                        href="#"
                        class="btn btn-block btn-lg btn-inverse"
                        >7</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn8"
                        onclick="event.preventDefault();addInput('8')"
                        href="#"
                        class="btn btn-block btn-lg btn-inverse"
                        >8</a
                      >
                    </td>
                    <td>
                      <a
                        id="btn9"
                        href="#"
                        onclick="event.preventDefault();addInput('9')"
                        class="btn btn-block btn-lg btn-inverse"
                        >9</a
                      >
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <a
                        id="btn0"
                        onclick="event.preventDefault();addInput('0')"
                        href="#"
                        class="btn btn-block btn-lg btn-inverse"
                        >0</a
                      >
                    </td>
                    <td colspan="2">
                      <a
                        id="btnClear"
                        href="#"
                        class="btn btn-block btn-lg btn-default text-uppercase"
                        >Clear</a
                      >
                    </td>
                  </tr>
                </table>
              </div>
              <!-- // Pin Pad -->

              <div id="confirmPin">
                <button
                  type="submit"
                  onclick="confirmAccount()"
                  class="btn btn-block btn-lg btn-success text-uppercase"
                >
                  Confirm
                </button>

                <!-- // Pin Pad -->
              </div>
              <div id="cancelTransaction">
                <a
                  href="#"
                  class="btn btn-block btn-lg btn-danger text-uppercase"
                  ><span class="fui-cross"></span> Cancel</a
                >
              </div>
              <div id="cancelTransaction">
                <a
                  href="#"
                  onclick="event.preventDefault();useFinger()"
                  class="btn btn-block btn-lg btn-primary text-uppercase"
                >
                  User Finger</a
                >
              </div>

              <!-- // Pin Pad -->
            </form>

            <div class="col-xs-4">
              <!-- add alert box -->
              <div
                class="alert alert-danger mt-4"
                style="margin-top: 3rem"
                role="alert"
                id="alertBox"
              ></div>
              <div style="margin-top: 8rem">
                <img
                  src="{{url_for('static', filename='img/CardInsertedGreenLight.png')}}"
                  style="width: 16em"
                />
              </div>
            </div>
            <!-- /.col-xs-4 -->
          </div>
          <!-- // END login screen  -->
        </div>
        <!--  // END column-->
        <div class="col-xs-12">
          <h2>
            <blockquote>
              This ATM System is for software testing only! ---
              <a href="#">sitemap</a>
            </blockquote>
          </h2>
        </div>
      </div>
      <!-- // END row-->
    </div>
    <!-- /container -->
    <script>
      var userPinInput = document.getElementById("userPinInput");
      //get query param accountNumber
      const params = new Proxy(new URLSearchParams(window.location.search), {
        get: (searchParams, prop) => searchParams.get(prop),
      });
      // Get the value of "some_key" in eg "https://example.com/?some_key=some_value"
      let value = params.accountNumber;
      let msg = params.msg;
      console.log(value);

      document.getElementById("accountNumber").value = value;
      if (msg) {
        document.getElementById(
          "alertBox"
        ).innerHTML = `<strong>${msg}</strong>`;
      }

      document
        .getElementById("btnClear")
        .addEventListener("click", function () {
          userPinInput.value = "";
        });
      document
        .getElementById("cancelTransaction")
        .addEventListener("click", function () {
          location.href = "/";
        });

      function addInput(number) {
        //check input character length in above 10
        if (userPinInput.value.length >= 4) {
          alert("Pin Number Must be 4 Digits");
          return;
        }
        userPinInput.value += number;
      }

      function confirmAccount() {
        if (userPinInput.value.length < 4) {
          alert("Pin Number Must be 4 Digits");
          return;
        }

        //submit the form
        document.getElementById("pinForm").submit();
        //location.href = "/confirm";
      }

      function navigateFunction(url) {
        window.location.href = url;
      }

      function useFinger() {
        document.getElementById(
          "alertBox"
        ).innerHTML = `<strong>Reading Fingerprint...</strong>`;
        setTimeout(function () {
          document.getElementById(
            "alertBox"
          ).innerHTML = `<strong>Fingerprint Read Successfully</strong>`;
          document.getElementById("pinForm").submit();
        }, 5000);
      }
    </script>

    <script src=" {{ url_for('static',filename='dist/js/vendor/jquery.min.js') }}"></script>
    <script src=" {{ url_for('static',filename='dist/js/vendor/video.js') }}"></script>
    <script src=" {{ url_for('static',filename='dist/js/flat-ui.min.js') }}"></script>
    <script src=" {{ url_for('static',filename='docs/assets/js/application.js') }}"></script>
  </body>
</html>
